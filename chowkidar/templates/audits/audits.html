{% extends "layout.html" %}
{% block content %}

<div class="flex-col flex items-center">
    <p class="flex items-center justify-center font-bold text-3xl text-gray-700">Your Audit Universe</p>
    <div class="mt-5 shadow-lg rounded-lg overflow-hidden mx-4 lg:mx-0">
        <table class="w-full table-fixed">
            <thead>
                <tr class="bg-blue-100">
                    <th class="w-1/3 sm:w-2/4 py-4 px-2 md:px-6 text-left text-gray-600 font-bold uppercase">
                        <div class="flex">
                            <span class="whitespace-nowrap">
                                Name
                            </span>
                            <div class="relative mx-3 w-full hidden lg:flex">
                                <div class="start-0 flex items-center ">
                                    <svg class="absolute flex-shrink-0 w-7 h-7" viewBox="0 -0.5 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                        <g id="SVGRepo_iconCarrier"> 
                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M11.132 9.71395C10.139 11.2496 10.3328 13.2665 11.6 14.585C12.8468 15.885 14.8527 16.0883 16.335 15.065C16.6466 14.8505 16.9244 14.5906 17.159 14.294C17.3897 14.0023 17.5773 13.679 17.716 13.334C18.0006 12.6253 18.0742 11.8495 17.928 11.1C17.7841 10.3573 17.4268 9.67277 16.9 9.12995C16.3811 8.59347 15.7128 8.22552 14.982 8.07395C14.2541 7.92522 13.4982 8.00197 12.815 8.29395C12.1254 8.58951 11.5394 9.08388 11.132 9.71395Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                            <path d="M17.5986 13.6868C17.2639 13.4428 16.7947 13.5165 16.5508 13.8513C16.3069 14.1861 16.3806 14.6552 16.7154 14.8991L17.5986 13.6868ZM19.0584 16.6061C19.3931 16.85 19.8623 16.7764 20.1062 16.4416C20.3501 16.1068 20.2764 15.6377 19.9416 15.3938L19.0584 16.6061ZM7.5 12.7499C7.91421 12.7499 8.25 12.4142 8.25 11.9999C8.25 11.5857 7.91421 11.2499 7.5 11.2499V12.7499ZM5.5 11.2499C5.08579 11.2499 4.75 11.5857 4.75 11.9999C4.75 12.4142 5.08579 12.7499 5.5 12.7499V11.2499ZM7.5 15.7499C7.91421 15.7499 8.25 15.4142 8.25 14.9999C8.25 14.5857 7.91421 14.2499 7.5 14.2499V15.7499ZM5.5 14.2499C5.08579 14.2499 4.75 14.5857 4.75 14.9999C4.75 15.4142 5.08579 15.7499 5.5 15.7499V14.2499ZM8.5 9.74994C8.91421 9.74994 9.25 9.41415 9.25 8.99994C9.25 8.58573 8.91421 8.24994 8.5 8.24994V9.74994ZM5.5 8.24994C5.08579 8.24994 4.75 8.58573 4.75 8.99994C4.75 9.41415 5.08579 9.74994 5.5 9.74994V8.24994ZM16.7154 14.8991L19.0584 16.6061L19.9416 15.3938L17.5986 13.6868L16.7154 14.8991ZM7.5 11.2499H5.5V12.7499H7.5V11.2499ZM7.5 14.2499H5.5V15.7499H7.5V14.2499ZM8.5 8.24994H5.5V9.74994H8.5V8.24994Z" fill="currentColor"></path> 
                                        </g>
                                    </svg>
                                    <input id="search-audit" class="mx-3 pl-4 font-normal peer block w-72 bg-transparent border-t-transparent border-b-2 border-x-transparent border-b-gray-500 text-sm focus:outline-none focus:border-t-transparent focus:border-r-transparent focus:border-l-transparent focus:border-b-indigo-500" placeholder="Audit Name / Audit Status / Date">
                                </div>
                            </div>
                        </div>
                    </th>
                    <th class="w-1/3 sm:w-1/4 py-4 px-4 text-left text-gray-600 font-bold uppercase hidden sm:table-cell">Date</th>
                    <th class="w-1/3 sm:w-1/4 py-4 px-4 text-left text-gray-600 font-bold uppercase">
                        <div class="flex">
                            <span class='mx-2'>Status</span>
                            <div class="relative">
                                <select id="statusFilter" onChange="handleSortChange()" class="w-5 text-gray-900 text-sm block bg-transparent border-transparent focus:outline-none appearance-none">
                                    <option value="">none</option>
                                    <option value="unscanned">unscanned</option>
                                    <option value="scanning">scanning</option>
                                    <option value="finished">finished</option>
                                    <option value="stopped">stopped</option>
                                </select>
                                
                                
                                <div class="absolute inset-y-0 right-0 flex items-center pointer-events-none bg-blue-100">
                                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                        <g id="SVGRepo_iconCarrier"> 
                                            <g id="Edit / Sort_Ascending"> 
                                                <path id="Vector" d="M4 17H10M4 12H13M18 11V19M18 19L21 16M18 19L15 16M4 7H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> 
                                            </g> 
                                        </g>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </th>
                    <th class="w-1/4 py-4 px-4 text-left text-gray-600 font-bold uppercase">Action</th>
                </tr>
            </thead>
        </table>
        <div class="w-full scrollable-table rounded-lg capitalize" id="all-audit">
            <table class="w-full table-fixed" id="audit-list">
                <tbody class="bg-white">
                    {% for audit in audits %}
                    <tr>
                        <td class="sm:w-2/4 py-4 px-4 border-b border-gray-200 truncate">
                            <div class="flex items-center">
                                <div class="hidden lg:block items-center">
                                    {% if 'web' in audit.asset_type %}
                                        <svg class="w-7" version="1.1" id="Icons" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" xml:space="preserve" fill="#000000">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier"> 
                                                <style type="text/css"> 
                                                    .st0{fill:none;stroke:#0ea5e9;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;} 
                                                    .st1{fill:none;stroke:#0ea5e9;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;} 
                                                    .st2{fill:none;stroke:#0ea5e9;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:5.2066,0;} 
                                                </style>
                                                <line class="st0" x1="3" y1="11" x2="29" y2="11"></line>
                                                <line class="st0" x1="7" y1="8" x2="7" y2="8"></line>
                                                <line class="st0" x1="10" y1="8" x2="10" y2="8"></line>
                                                <line class="st0" x1="13" y1="8" x2="13" y2="8"></line>
                                                <path class="st0" d="M8.8,27H3V5h26v22l-5.8,0c0.3-0.1,0.6-0.1,0.9-0.1c0.1-0.6,0.2-1.3,0.2-1.9c0-0.7-0.1-1.3-0.2-1.9c-1,0.1-2-0.3-2.5-1.3c-0.5-0.9-0.4-2,0.2-2.8c-0.9-0.9-2.1-1.6-3.4-2c-0.4,0.9-1.3,1.6-2.4,1.6s-2-0.7-2.4-1.6c-1.3,0.4-2.4,1.1-3.4,2c0.6,0.8,0.7,1.9,0.2,2.8c-0.5,0.9-1.6,1.4-2.5,1.3c-0.1,0.6-0.2,1.3-0.2,1.9c0,0.7,0.1,1.3,0.2,1.9C8.2,26.9,8.5,26.9,8.8,27L8.8,27z"></path>
                                                <circle class="st0" cx="16" cy="25" r="3"></circle>
                                            </g>
                                        </svg>
                                        <p class="text-[0.5rem] text-center font-bold text-sky-500 select-none">Web</p>

                                    {% elif 'aws' in audit.asset_type %}
                                        <svg class="w-7" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="none">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier">
                                                <path fill="#252F3E" d="M4.51 7.687c0 .197.02.357.058.475.042.117.096.245.17.384a.233.233 0 01.037.123c0 .053-.032.107-.1.16l-.336.224a.255.255 0 01-.138.048c-.054 0-.107-.026-.16-.074a1.652 1.652 0 01-.192-.251 4.137 4.137 0 01-.165-.315c-.415.491-.936.737-1.564.737-.447 0-.804-.129-1.064-.385-.261-.256-.394-.598-.394-1.025 0-.454.16-.822.484-1.1.325-.278.756-.416 1.304-.416.18 0 .367.016.564.042.197.027.4.07.612.118v-.39c0-.406-.085-.689-.25-.854-.17-.166-.458-.246-.868-.246-.186 0-.377.022-.574.07a4.23 4.23 0 00-.575.181 1.525 1.525 0 01-.186.07.326.326 0 01-.085.016c-.075 0-.112-.054-.112-.166v-.262c0-.085.01-.15.037-.186a.399.399 0 01.15-.113c.185-.096.409-.176.67-.24.26-.07.537-.101.83-.101.633 0 1.096.144 1.394.432.293.288.442.726.442 1.314v1.73h.01zm-2.161.811c.175 0 .356-.032.548-.096.191-.064.362-.182.505-.342a.848.848 0 00.181-.341c.032-.129.054-.283.054-.465V7.03a4.43 4.43 0 00-.49-.09 3.996 3.996 0 00-.5-.033c-.357 0-.618.07-.793.214-.176.144-.26.347-.26.614 0 .25.063.437.196.566.128.133.314.197.559.197zm4.273.577c-.096 0-.16-.016-.202-.054-.043-.032-.08-.106-.112-.208l-1.25-4.127a.938.938 0 01-.049-.214c0-.085.043-.133.128-.133h.522c.1 0 .17.016.207.053.043.032.075.107.107.208l.894 3.535.83-3.535c.026-.106.058-.176.1-.208a.365.365 0 01.214-.053h.425c.102 0 .17.016.213.053.043.032.08.107.101.208l.841 3.578.92-3.578a.458.458 0 01.107-.208.346.346 0 01.208-.053h.495c.085 0 .133.043.133.133 0 .027-.006.054-.01.086a.76.76 0 01-.038.133l-1.283 4.127c-.032.107-.069.177-.111.209a.34.34 0 01-.203.053h-.457c-.101 0-.17-.016-.213-.053-.043-.038-.08-.107-.101-.214L8.213 5.37l-.82 3.439c-.026.107-.058.176-.1.213-.043.038-.118.054-.213.054h-.458zm6.838.144a3.51 3.51 0 01-.82-.096c-.266-.064-.473-.134-.612-.214-.085-.048-.143-.101-.165-.15a.378.378 0 01-.031-.149v-.272c0-.112.042-.166.122-.166a.3.3 0 01.096.016c.032.011.08.032.133.054.18.08.378.144.585.187.213.042.42.064.633.064.336 0 .596-.059.777-.176a.575.575 0 00.277-.508.52.52 0 00-.144-.373c-.095-.102-.276-.193-.537-.278l-.772-.24c-.388-.123-.676-.305-.851-.545a1.275 1.275 0 01-.266-.774c0-.224.048-.422.143-.593.096-.17.224-.32.384-.438.16-.122.34-.213.553-.277.213-.064.436-.091.67-.091.118 0 .24.005.357.021.122.016.234.038.346.06.106.026.208.052.303.085.096.032.17.064.224.096a.46.46 0 01.16.133.289.289 0 01.047.176v.251c0 .112-.042.171-.122.171a.552.552 0 01-.202-.064 2.427 2.427 0 00-1.022-.208c-.303 0-.543.048-.708.15-.165.1-.25.256-.25.475 0 .149.053.277.16.379.106.101.303.202.585.293l.756.24c.383.123.66.294.825.513.165.219.244.47.244.748 0 .23-.047.437-.138.619a1.436 1.436 0 01-.388.47c-.165.133-.362.23-.591.299-.24.075-.49.112-.761.112z"></path>
                                                <g fill="#F90" fill-rule="evenodd" clip-rule="evenodd">
                                                    <path d="M14.465 11.813c-1.75 1.297-4.294 1.986-6.481 1.986-3.065 0-5.827-1.137-7.913-3.027-.165-.15-.016-.353.18-.235 2.257 1.313 5.04 2.109 7.92 2.109 1.941 0 4.075-.406 6.039-1.239.293-.133.543.192.255.406z"></path>
                                                    <path d="M15.194 10.98c-.223-.287-1.479-.138-2.048-.069-.17.022-.197-.128-.043-.24 1-.705 2.645-.502 2.836-.267.192.24-.053 1.89-.99 2.68-.143.123-.281.06-.218-.1.213-.53.687-1.72.463-2.003z"></path>
                                                </g>
                                            </g>
                                        </svg>
                                        <p class="text-[0.5rem] text-center font-bold text-red-500 select-none">cloud</p>

                                    {% elif 'azure' in audit.asset_type %}
                                        <svg class="w-7" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="none">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier">
                                                <g fill="#0089D6">
                                                    <path d="M7.47 12.412l3.348-.592.031-.007-1.722-2.049a291.474 291.474 0 01-1.723-2.058c0-.01 1.779-4.909 1.789-4.926a788.95 788.95 0 012.934 5.066l2.95 5.115.023.039-10.948-.001 3.317-.587zM.9 11.788c0-.003.811-1.412 1.803-3.131L4.507 5.53l2.102-1.764C7.765 2.797 8.714 2 8.717 2a.37.37 0 01-.033.085L6.4 6.981 4.16 11.789l-1.63.002c-.897.001-1.63 0-1.63-.003z"></path>
                                                </g>
                                            </g>
                                        </svg>
                                        <p class="text-[0.5rem] text-center font-bold text-red-500 select-none">cloud</p>

                                    {% elif 'gcp' in audit.asset_type %}
                                        <svg class="w-7" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="none">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier">
                                                <path fill="#EA4335" d="M10.313 5.376l1.887-1.5-.332-.414a5.935 5.935 0 00-5.586-1.217 5.89 5.89 0 00-3.978 4.084c-.03.113.312-.098.463-.056l2.608-.428s.127-.124.201-.205c1.16-1.266 3.126-1.432 4.465-.354l.272.09z"></path>
                                                <path fill="#4285F4" d="M13.637 6.3a5.835 5.835 0 00-1.77-2.838l-1.83 1.82a3.226 3.226 0 011.193 2.564v.323c.9 0 1.63.725 1.63 1.62 0 .893-.73 1.619-1.63 1.619l-3.257-.003-.325.035v2.507l.325.053h3.257a4.234 4.234 0 004.08-2.962A4.199 4.199 0 0013.636 6.3z"></path>
                                                <path fill="#34A853" d="M4.711 13.999H7.97v-2.594H4.71c-.232 0-.461-.066-.672-.161l-.458.14-1.313 1.297-.114.447a4.254 4.254 0 002.557.87z"></path>
                                                <path fill="#FBBC05" d="M4.711 5.572A4.234 4.234 0 00.721 8.44a4.206 4.206 0 001.433 4.688l1.89-1.884a1.617 1.617 0 01.44-3.079 1.63 1.63 0 011.714.936l1.89-1.878A4.24 4.24 0 004.71 5.572z"></path>
                                            </g>
                                        </svg>
                                        <p class="text-[0.5rem] text-center font-bold text-red-500 select-none">cloud</p>

                                    {% else %}
                                        <svg class="w-8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier">
                                                <path opacity="0.5" d="M2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12Z" stroke="#00020a" stroke-width="1.5"></path>
                                                <path d="M10.125 8.875C10.125 7.83947 10.9645 7 12 7C13.0355 7 13.875 7.83947 13.875 8.875C13.875 9.56245 13.505 10.1635 12.9534 10.4899C12.478 10.7711 12 11.1977 12 11.75V13" stroke="#00020a" stroke-width="1.5" stroke-linecap="round"></path>
                                                <circle cx="12" cy="16" r="1" fill="#00020a"></circle>
                                            </g>
                                        </svg>
                                        <p class="text-[0.5rem] text-center font-bold text-gray-900 select-none">other</p>
                                    {% endif %}
                                </div>
                                <div class="ml-3">
                                    <a href="{{ url_for('audits.audit', audit_name=audit.name) }}">
                                        {% if audit.name|length > 50 %}
                                        <span class="group">
                                            {{ audit.name }}
                                            <div class='absolute hidden sm:group-hover:block mt-1 bg-black rounded-md p-1 px-2 triangle-top'>
                                                <span class='text-white text-xs hover:font-bold'>{{ audit.name }}</span>
                                            </div>
                                        </span>
                                        {% else %}
                                        <p class="group inline-block">
                                            <span class="relative inline-block transition-all duration-300">{{ audit.name }}
                                                <span class="absolute inset-x-0 bottom-0 h-0.5 bg-blue-300 w-0 transition-all duration-300 sm:group-hover:w-full"></span>
                                            </span>
                                        </p>
                                        {% endif %}
                                    </a>
                                    <p class="text-[0.65rem] normal-case text-slate-600">{{ audit.url }}</p>
                                </div>
                            </div>
                        </td>
                        <td class="w-1/3 sm:w-1/4 py-4 px-4 border-b border-gray-200 truncate hidden sm:table-cell">{{ audit.date.strftime('%d %b %Y') }}</td>
                        <td class="w-1/3 sm:w-1/4 py-4 px-4 border-b border-gray-200">
                            {% if audit.status == 'unscanned' %}
                                <span class="px-2 inline-flex text-sm leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">{{ audit.status }}</span>
                            {% elif 'scanning' in audit.status %}
                                <span class="px-2 inline-flex text-sm leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">{{ audit.status }}</span>
                            {% elif audit.status == 'finished' %}
                                <span class="px-2 inline-flex text-sm leading-5 font-semibold rounded-full bg-green-100 text-green-800">{{ audit.status }}</span>
                            {% elif audit.status == 'stopped' %}
                                <span class="px-2 inline-flex text-sm leading-5 font-semibold rounded-full bg-red-100 text-red-800">{{ audit.status }}</span>
                            {% endif %}
                        </td>
                        <td class="w-1/3 sm:w-1/4 py-4 px-4 border-b border-gray-200">
                            <div class='flex gap-1'>
                                <div class='flex items-center justify-center p-2 rounded-md hover:bg-red-200 group' data-toggle="deleteModal" data-target="#deleteModal" data-audit-name="{{ audit.name }}" data-delete-url="{{ url_for('audits.delete_audit', audit_name=audit.name) }}">
                                    <svg class="w-6 h-6 flex-none" fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" viewBox="0 0 482.428 482.429" xmlSpace="preserve">
                                        <g id="SVGRepo_bgCarrier" strokeWidth="0"></g>
                                        <g id="SVGRepo_tracerCarrier" strokeLinecap="round" strokeLinejoin="round"></g>
                                        <g id="SVGRepo_iconCarrier">
                                            <g>
                                                <g>
                                                    <path d="M381.163,57.799h-75.094C302.323,25.316,274.686,0,241.214,0c-33.471,0-61.104,25.315-64.85,57.799h-75.098 c-30.39,0-55.111,24.728-55.111,55.117v2.828c0,23.223,14.46,43.1,34.83,51.199v260.369c0,30.39,24.724,55.117,55.112,55.117 h210.236c30.389,0,55.111-24.729,55.111-55.117V166.944c20.369-8.1,34.83-27.977,34.83-51.199v-2.828 C436.274,82.527,411.551,57.799,381.163,57.799z M241.214,26.139c19.037,0,34.927,13.645,38.443,31.66h-76.879 C206.293,39.783,222.184,26.139,241.214,26.139z M375.305,427.312c0,15.978-13,28.979-28.973,28.979H136.096 c-15.973,0-28.973-13.002-28.973-28.979V170.861h268.182V427.312z M410.135,115.744c0,15.978-13,28.979-28.973,28.979H101.266 c-15.973,0-28.973-13.001-28.973-28.979v-2.828c0-15.978,13-28.979,28.973-28.979h279.897c15.973,0,28.973,13.001,28.973,28.979 V115.744z"></path>
                                                    <path d="M171.144,422.863c7.218,0,13.069-5.853,13.069-13.068V262.641c0-7.216-5.852-13.07-13.069-13.07 c-7.217,0-13.069,5.854-13.069,13.07v147.154C158.074,417.012,163.926,422.863,171.144,422.863z"></path>
                                                    <path d="M241.214,422.863c7.218,0,13.07-5.853,13.07-13.068V262.641c0-7.216-5.854-13.07-13.07-13.07 c-7.217,0-13.069,5.854-13.069,13.07v147.154C228.145,417.012,233.996,422.863,241.214,422.863z"></path>
                                                    <path d="M311.284,422.863c7.217,0,13.068-5.853,13.068-13.068V262.641c0-7.216-5.852-13.07-13.068-13.07 c-7.219,0-13.07,5.854-13.07,13.07v147.154C298.213,417.012,304.067,422.863,311.284,422.863z"></path>
                                                </g>
                                            </g>
                                        </g>
                                    </svg>
                                    <div class='absolute hidden group-hover:block mt-20 bg-black rounded-md p-1 px-2 action-triangle-top'>
                                        <span class='text-white text-xs normal-case font-normal whitespace-nowrap'>Delete Audit</span>
                                    </div>
                                </div>
                                {% if audit.status == 'unscanned' %}
                                    <div class='flex items-center justify-center p-2 rounded-md hover:bg-green-200 group' data-toggle="initiateAuditModal" data-target="#initiateAuditModal" data-audit-name="{{ audit.name }}" data-initiate-audit-url="{{ url_for('audits.scan_audit', audit_name=audit.name) }}">
                                        <svg class="w-6 h-6 flex-none" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <g id="SVGRepo_bgCarrier" strokeWidth="1.5"></g>
                                            <g id="SVGRepo_tracerCarrier" strokeLinecap="round" strokeLinejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier">
                                                <path d="M3 12L3 18.9671C3 21.2763 5.53435 22.736 7.59662 21.6145L10.7996 19.8727M3 8L3 5.0329C3 2.72368 5.53435 1.26402 7.59661 2.38548L20.4086 9.35258C22.5305 10.5065 22.5305 13.4935 20.4086 14.6474L14.0026 18.131" stroke="currentColor" stroke-width="1.2" strokeLinecap="round"></path>
                                            </g>
                                        </svg>
                                        <div class='absolute hidden group-hover:block mt-20 bg-black rounded-md p-1 px-2 action-triangle-top'>
                                            <span class='text-white text-xs normal-case font-normal whitespace-nowrap'>Initiate Audit</span>
                                        </div>
                                    </div>
                                {% elif audit.status == 'finished' %}
                                    <a href="{{ url_for('audits.vulnerabilities', audit_name=audit.name) }}">
                                        <div class="flex items-center justify-center p-2 rounded-md hover:bg-cyan-200 group">
                                            <svg class="w-6 h-6 flex-none" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                                <g id="SVGRepo_iconCarrier"> 
                                                    <path d="M18.18 8.03933L18.6435 7.57589C19.4113 6.80804 20.6563 6.80804 21.4241 7.57589C22.192 8.34374 22.192 9.58868 21.4241 10.3565L20.9607 10.82M18.18 8.03933C18.18 8.03933 18.238 9.02414 19.1069 9.89309C19.9759 10.762 20.9607 10.82 20.9607 10.82M18.18 8.03933L13.9194 12.2999C13.6308 12.5885 13.4865 12.7328 13.3624 12.8919C13.2161 13.0796 13.0906 13.2827 12.9882 13.4975C12.9014 13.6797 12.8368 13.8732 12.7078 14.2604L12.2946 15.5L12.1609 15.901M20.9607 10.82L16.7001 15.0806C16.4115 15.3692 16.2672 15.5135 16.1081 15.6376C15.9204 15.7839 15.7173 15.9094 15.5025 16.0118C15.3203 16.0986 15.1268 16.1632 14.7396 16.2922L13.5 16.7054L13.099 16.8391M13.099 16.8391L12.6979 16.9728C12.5074 17.0363 12.2973 16.9867 12.1553 16.8447C12.0133 16.7027 11.9637 16.4926 12.0272 16.3021L12.1609 15.901M13.099 16.8391L12.1609 15.901" stroke="currentColor" stroke-width="1.5"></path> 
                                                    <path d="M8 13H10.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path> 
                                                    <path d="M8 9H14.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path> 
                                                    <path d="M8 17H9.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path> 
                                                    <path d="M3 14V10C3 6.22876 3 4.34315 4.17157 3.17157C5.34315 2 7.22876 2 11 2H13C16.7712 2 18.6569 2 19.8284 3.17157M21 14C21 17.7712 21 19.6569 19.8284 20.8284M4.17157 20.8284C5.34315 22 7.22876 22 11 22H13C16.7712 22 18.6569 22 19.8284 20.8284M19.8284 20.8284C20.7715 19.8853 20.9554 18.4796 20.9913 16" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path> 
                                                </g>
                                            </svg>
                                            <div class='absolute hidden group-hover:block mt-20 bg-black rounded-md p-1 px-2 action-triangle-top'>
                                                <span class='text-white text-xs normal-case font-normal whitespace-nowrap'>Report</span>
                                            </div>
                                        </div>
                                    </a>
                                {% elif 'scanning' in audit.status %}
                                <a href="{{ url_for('audits.stop_scan', audit_name=audit.name) }}">
                                    <div class="flex items-center justify-center p-2 rounded-md hover:bg-yellow-200 group">
                                        <svg class="w-6 h-6 flex-none" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier"> 
                                                <path d="M14.5 9.50002L9.5 14.5M9.49998 9.5L14.5 14.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path> 
                                                <path d="M7 3.33782C8.47087 2.48697 10.1786 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 10.1786 2.48697 8.47087 3.33782 7" stroke="currentColor" stroke-width="1" stroke-linecap="round"></path> 
                                            </g>
                                        </svg>
                                        <div class='absolute hidden group-hover:block mt-20 bg-black rounded-md p-1 px-2 action-triangle-top'>
                                            <span class='text-white text-xs normal-case font-normal whitespace-nowrap'>Stop Scan</span>
                                        </div>
                                    </div>
                                </a>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Delete Modal -->
<div id="deleteModal" class="fixed z-10 inset-0 overflow-y-auto hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="flex items-end justify-center min-h-screen pt-4 px-6 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <form id="submitForm" action="" method="POST">
            <div class="bg-white px-6 pt-5 pb-4 sm:p-6 sm:pb-4">
                <div class="sm:flex sm:items-start">
                    <div class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
                        <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                        </svg>
                      </div>
                    <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                        <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">
                            Delete Audit
                        </h3>
                        <div class="mt-2">
                            <p class="text-sm text-gray-500 pb-3" id="auditDeleteMessage">
                                
                            </p>
                            <p class="text-sm text-gray-500">
                                All of your data associated with this audit will be permanently removed. This action cannot be undone.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <button type="submit"  class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-6 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 sm:ml-3 sm:w-auto sm:text-sm" id="deleteConfirm">
                    Delete
                </button>
                <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-6 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:mt-0 sm:w-auto sm:text-sm" id="deleteCancel">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Initiate Audit Modal -->
<div id="initiateAuditModal" class="fixed z-10 inset-0 overflow-y-auto hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="flex items-end justify-center min-h-screen pt-4 px-6 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <form id="submitForm" action="" method="POST">
            <div class="bg-white px-6 pt-5 pb-4 sm:p-6 sm:pb-4">
                <div class="sm:flex sm:items-start">
                    <div class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-green-100 sm:mx-0 sm:h-10 sm:w-10">
                        <svg class="h-6 w-6 text-red-600" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier"> 
                                <path d="M12 6L12 18" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                <path d="M9 9L9 15" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                <path d="M18 11L18 13" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                <path d="M6 11L6 13" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                <path d="M15 7L15 17" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                <path d="M6 3H3V6" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                <path d="M18 3H21V6" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                <path d="M6 21H3V18" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                                <path d="M18 21H21V18" stroke="#16a34a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
                            </g>
                        </svg>
                      </div>
                    <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                        <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">
                            Initiate Audit Scan
                        </h3>
                        <div class="mt-2">
                            <p class="text-sm text-gray-500 pb-3" id="auditScanMessage">
                                
                            </p>
                            <p class="text-sm text-gray-500">
                                I acknowledge and am willing to accept the risks involved; during the audit, the scanner will generate some traffic.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <button type="submit"  class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-6 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 sm:ml-3 sm:w-auto sm:text-sm" id="initiateAuditConfirm">
                    Initiate Audit
                </button>
                <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-6 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:mt-0 sm:w-auto sm:text-sm" id="initiateAuditCancel">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

{% endblock content %}